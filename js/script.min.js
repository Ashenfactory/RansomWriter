var Detector=function(){var baseFonts=["monospace","sans-serif","serif"];var testString="mmmmmmmmmmlli";var testSize="72px";var h=document.body;var s=document.createElement("span");s.style.fontSize=testSize;s.innerHTML=testString;var defaultWidth={};var defaultHeight={};for(var index in baseFonts){s.style.fontFamily=baseFonts[index];h.appendChild(s);defaultWidth[baseFonts[index]]=s.offsetWidth;defaultHeight[baseFonts[index]]=s.offsetHeight;h.removeChild(s)}function detect(font){var detected=false;for(var index in baseFonts){s.style.fontFamily=font+","+baseFonts[index];h.appendChild(s);var matched=s.offsetWidth!=defaultWidth[baseFonts[index]]||s.offsetHeight!=defaultHeight[baseFonts[index]];h.removeChild(s);detected=detected||matched}return detected}this.detect=detect};var MersenneTwister=function(seed){if(seed===undefined){seed=(new Date).getTime()}this.N=624;this.M=397;this.MATRIX_A=2567483615;this.UPPER_MASK=2147483648;this.LOWER_MASK=2147483647;this.mt=new Array(this.N);this.mti=this.N+1;this.init_genrand(seed)};MersenneTwister.prototype.init_genrand=function(s){this.mt[0]=s>>>0;for(this.mti=1;this.mti<this.N;this.mti++){s=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(((s&4294901760)>>>16)*1812433253<<16)+(s&65535)*1812433253+this.mti;this.mt[this.mti]>>>=0}};MersenneTwister.prototype.init_by_array=function(init_key,key_length){var i,j,k;this.init_genrand(19650218);i=1;j=0;k=this.N>key_length?this.N:key_length;for(;k;k--){var s1=this.mt[i-1]^this.mt[i-1]>>>30;this.mt[i]=(this.mt[i]^(((s1&4294901760)>>>16)*1664525<<16)+(s1&65535)*1664525)+init_key[j]+j;this.mt[i]>>>=0;i++;j++;if(i>=this.N){this.mt[0]=this.mt[this.N-1];i=1}if(j>=key_length)j=0}for(k=this.N-1;k;k--){var s2=this.mt[i-1]^this.mt[i-1]>>>30;this.mt[i]=(this.mt[i]^(((s2&4294901760)>>>16)*1566083941<<16)+(s2&65535)*1566083941)-i;this.mt[i]>>>=0;i++;if(i>=this.N){this.mt[0]=this.mt[this.N-1];i=1}}this.mt[0]=2147483648};MersenneTwister.prototype.genrand_int32=function(){var y;var mag01=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var kk;if(this.mti==this.N+1)this.init_genrand(5489);for(kk=0;kk<this.N-this.M;kk++){y=this.mt[kk]&this.UPPER_MASK|this.mt[kk+1]&this.LOWER_MASK;this.mt[kk]=this.mt[kk+this.M]^y>>>1^mag01[y&1]}for(;kk<this.N-1;kk++){y=this.mt[kk]&this.UPPER_MASK|this.mt[kk+1]&this.LOWER_MASK;this.mt[kk]=this.mt[kk+(this.M-this.N)]^y>>>1^mag01[y&1]}y=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK;this.mt[this.N-1]=this.mt[this.M-1]^y>>>1^mag01[y&1];this.mti=0}y=this.mt[this.mti++];y^=y>>>11;y^=y<<7&2636928640;y^=y<<15&4022730752;y^=y>>>18;return y>>>0};MersenneTwister.prototype.genrand_int31=function(){return this.genrand_int32()>>>1};MersenneTwister.prototype.genrand_real1=function(){return this.genrand_int32()*(1/4294967295)};MersenneTwister.prototype.random=function(){return this.genrand_int32()*(1/4294967296)};MersenneTwister.prototype.genrand_real3=function(){return(this.genrand_int32()+.5)*(1/4294967296)};MersenneTwister.prototype.genrand_res53=function(){var a=this.genrand_int32()>>>5,b=this.genrand_int32()>>>6;return(a*67108864+b)*(1/9007199254740992)};var forEach=function(array,callback,scope){for(var i=0;i<array.length;i++){callback.call(scope,i,array[i])}};function getSelectValues(select){var result=[];var options=select&&select.options;var opt;for(var i=0,iLen=options.length;i<iLen;i++){opt=options[i];if(opt.selected){result.push(opt.value||opt.text)}}return result}function randomPercentage(threshold){var n=Math.floor(m.random()*100);return n<threshold}function pickArrayMember(array){return array[Math.floor(m.random()*array.length)]}function setOutputProperty(property,value,defaultValue){if(!value){value=defaultValue}document.getElementById("textOutput").style[property]=value}function applyFonts(){var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){value.style.fontFamily='"'+pickArrayMember(settings.fonts)+'"'})}function applyColors(){var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){var color=randomPercentage(20)?pickArrayMember(whites):pickArrayMember(colors);value.style.backgroundColor=color.background;value.style.color=color.color;if(color.background==="#fff"){value.style.border="1px #ccc solid"}})}function applySizes(){var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){var size=(m.random()*75-37.5)/100*settings.size+settings.size;value.style.fontSize=size+"px"})}function applyTilts(){var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){value.style.transform="rotate("+(m.random()*15-7.5)+"deg)"})}function applySpaces(){var elements=document.getElementById("textOutput").querySelectorAll(".space");forEach(elements,function(index,value){value.innerHTML=pickArrayMember(spaces)})}function applyCases(){var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){if(randomPercentage(20)){value.style.textTransform="uppercase"}else{value.style.textTransform="lowercase"}})}function applyStyles(){var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){if(randomPercentage(30)){value.style.fontStyle="italic"}else{value.style.fontStyle="normal"}})}function applyWeights(){var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){value.style.fontWeight=Math.floor(m.random()*9)*100})}function formatText(){var formattedText='<div class="word">';var letterGroup=false;for(var i=0;i<settings.text.length;i++){var code=settings.text.charCodeAt(i);var char=settings.text.charAt(i);if(code===13&&settings.text.charCodeAt(i+1)===10){continue}else if(code===13||code===10){if(letterGroup){letterGroup=false;formattedText+="</div>"}formattedText+='</div><br><div class="word">'}else if(char===" "){if(letterGroup){letterGroup=false;formattedText+="</div>"}formattedText+='<div class="space">&nbsp;</div></div><div class="word">'}else{if(!letterGroup){formattedText+='<div class="letter">'}formattedText+=char;if(settings.grouped&&randomPercentage(30)){letterGroup=true}else{letterGroup=false;formattedText+="</div>"}}}formattedText+="</div>";document.getElementById("textOutput").innerHTML=formattedText;if(settings.spaced){applySpaces()}if(settings.cased){applyCases()}if(settings.tilted){applyTilts()}if(settings.colored){applyColors()}if(settings.fonts){applyFonts()}if(settings.sized){applySizes()}if(settings.styled){applyStyles()}if(settings.weighted){applyWeights()}}function isNumber(n){return!isNaN(parseFloat(n))&&isFinite(n)}var hash=function(s){var a=1,c=0,h,o;if(s){a=0;for(h=s.length-1;h>=0;h--){o=s.charCodeAt(h);a=(a<<6&268435455)+o+(o<<14);c=a&266338304;a=c!==0?a^c>>21:a}}return String(a)};function saveImage(){domtoimage.toBlob(document.getElementById("textOutput")).then(function(blob){var fr=new FileReader;fr.addEventListener("loadend",function(e){window.saveAs(blob,"rw_"+hash(e.target.result)+".png")});fr.readAsText(blob)})}function selectAllFonts(fontsInput){var change=new Event("change");for(var i=0;i<fontsInput.options.length;i++){fontsInput.options[i].selected=true}fontsInput.dispatchEvent(change)}function invertFonts(fontsInput){var change=new Event("change");for(var i=0;i<fontsInput.options.length;i++){fontsInput.options[i].selected=!fontsInput.options[i].selected}fontsInput.dispatchEvent(change)}function selectAllOptions(checkboxes){var change=new Event("change");for(var i=0;i<checkboxes.length;i++){checkboxes[i].checked=true;checkboxes[i].dispatchEvent(change)}}function invertOptions(checkboxes){var change=new Event("change");for(var i=0;i<checkboxes.length;i++){checkboxes[i].checked=!checkboxes[i].checked;checkboxes[i].dispatchEvent(change)}}var qd={};if(location.search)location.search.substr(1).split("&").forEach(function(item){var s=item.split("="),k=s[0],v=s[1]&&decodeURIComponent(s[1]);(qd[k]=qd[k]||[]).push(v)});var d=new Detector;var whites=[{color:"#0074d9",background:"#fff"},{color:"#001f3f",background:"#fff"},{color:"#3d9970",background:"#fff"},{color:"#ff4136",background:"#fff"},{color:"#85144b",background:"#fff"},{color:"#b10dc9",background:"#fff"},{color:"#f012be",background:"#fff"},{color:"#111",background:"#fff"}];var colors=[{color:"#7fdbff",background:"#111"},{color:"#0074d9",background:"#111"},{color:"#01ff70",background:"#111"},{color:"#39cccc",background:"#111"},{color:"#3d9970",background:"#111"},{color:"#2ecc40",background:"#111"},{color:"#ff4136",background:"#111"},{color:"#ff851b",background:"#111"},{color:"#b10dc9",background:"#111"},{color:"#ffdc06",background:"#111"},{color:"#f012be",background:"#111"},{color:"#aaa",background:"#111"},{color:"#fff",background:"#111"},{color:"#ddd",background:"#111"},{color:"#0074d9",background:"#ddd"},{color:"#001f3f",background:"#ddd"},{color:"#85144b",background:"#ddd"},{color:"#fff",background:"#ddd"},{color:"#111",background:"#ddd"},{color:"#001f3f",background:"#aaa"},{color:"#85144b",background:"#aaa"},{color:"#111",background:"#aaa"},{color:"#001f3f",background:"#f012be"},{color:"#fff",background:"#f012be"},{color:"#111",background:"#f012be"},{color:"#b10dc9",background:"#ffdc00"},{color:"#85144b",background:"#ffdc00"},{color:"#001f3f",background:"#ffdc00"},{color:"#0074d9",background:"#ffdc00"},{color:"#111",background:"#ffdc00"},{color:"#01ff70",background:"#b10dc9"},{color:"#ddd",background:"#b10dc9"},{color:"#111",background:"#b10dc9"},{color:"#fff",background:"#b10dc9"},{color:"#ffdc00",background:"#b10dc9"},{color:"#85144b",background:"#ff851b"},{color:"#001f3f",background:"#ff851b"},{color:"#111",background:"#ff851b"},{color:"#01ff70",background:"#85144b"},{color:"#7fdbff",background:"#85144b"},{color:"#2ecc40",background:"#85144b"},{color:"#ff851b",background:"#85144b"},{color:"#ffdc00",background:"#85144b"},{color:"#aaa",background:"#85144b"},{color:"#fff",background:"#85144b"},{color:"#ddd",background:"#85144b"},{color:"#001f3f",background:"#ff4136"},{color:"#fff",background:"#ff4136"},{color:"#111",background:"#ff4136"},{color:"#001f3f",background:"#7fdbff"},{color:"#85144b",background:"#7fdbff"},{color:"#f012be",background:"#7fdbff"},{color:"#111",background:"#7fdbff"},{color:"#01ff70",background:"#0074d9"},{color:"#001f3f",background:"#0074d9"},{color:"#ffdc00",background:"#0074d9"},{color:"#fff",background:"#0074d9"},{color:"#111",background:"#0074d9"},{color:"#ddd",background:"#0074d9"},{color:"#0074d9",background:"#001f3f"},{color:"#7fdbff",background:"#001f3f"},{color:"#3d9970",background:"#001f3f"},{color:"#2ecc40",background:"#001f3f"},{color:"#01ff70",background:"#001f3f"},{color:"#ff4136",background:"#001f3f"},{color:"#ff851b",background:"#001f3f"},{color:"#ffdc00",background:"#001f3f"},{color:"#f012be",background:"#001f3f"},{color:"#aaa",background:"#001f3f"},{color:"#ddd",background:"#001f3f"},{color:"#fff",background:"#001f3f"},{color:"#001f3f",background:"#39cccc"},{color:"#85144b",background:"#39cccc"},{color:"#111",background:"#39cccc"},{color:"#0074d9",background:"#01ff70"},{color:"#001f3f",background:"#01ff70"},{color:"#85144b",background:"#01ff70"},{color:"#f012be",background:"#01ff70"},{color:"#111",background:"#01ff70"},{color:"#001f3f",background:"#3d9970"},{color:"#fff",background:"#3d9970"},{color:"#111",background:"#3d9970"},{color:"#001f3f",background:"#2ecc40"},{color:"#111",background:"#2ecc40"},{color:"#85144b",background:"#2ecc40"}];var testFonts=["Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bauhaus 93","Bookman Old Style","Bradly Hand ITC","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier New","Dejavu Sans","Frutiger","Frutiger Linotype","Georgia","Gentium","Helvetica Neue","Impact","Jokerman","King","Lucida Console","Lalit","Magneto","Modena","Monotype Corsiva","Roboto","Papyrus","Segoe UI","Stencil","Tahoma","TeX","Times New Roman","Trebuchet MS","Verdana","Verona"];var spaces=["&nbsp;","&ensp;","&emsp;","&#8196;","&#8197;","&#8198;","&#8200;"];var settings={cased:qd.cased&&qd.cased[0]!==undefined?true:false,tilted:qd.tilted&&qd.tilted[0]!==undefined?true:false,spaced:qd.spaced&&qd.spaced[0]!==undefined?true:false,fonts:qd.fonts&&qd.fonts[0]!==undefined?qd.fonts:false,colored:qd.colored&&qd.colored[0]!==undefined?true:false,sized:qd.sized&&qd.sized[0]!==undefined?qd.sized[0]:false,grouped:qd.grouped&&qd.grouped[0]!==undefined?qd.grouped[0]:false,styled:qd.styled&&qd.styled[0]!==undefined?qd.styled[0]:false,weighted:qd.weighted&&qd.weighted[0]!==undefined?qd.weighted[0]:false,seed:qd.seed&&qd.seed[0]!==undefined?qd.seed[0]:undefined,text:qd.text&&qd.text[0]!==undefined?qd.text[0]:undefined,size:qd.size&&qd.size[0]!==undefined?qd.size[0]:50,width:qd.width&&qd.width[0]!==undefined?qd.width[0]:"auto",align:qd.align&&qd.align[0]!==undefined?qd.align[0]:"left"};var m=new MersenneTwister(settings.seed);if(settings.text){settings.text=settings.text.replace(/\+/g," ")}else{settings.text="We have your magazines,\nsend money or we'll cut out more letters"}document.getElementById("textInput").innerHTML=settings.text;if(settings.fonts){settings.fonts=settings.fonts.map(Number)}var fontsInput=document.getElementById("fontsInput");var checkboxes=document.getElementById("settingsOptions").querySelectorAll("input[type=checkbox]");var fontsHTML="";for(var i=0;i<testFonts.length;i++){if(d.detect(testFonts[i])){fontsHTML+='<option value="'+i+'" style="font-family: \''+testFonts[i]+"';\""+(settings.fonts&&settings.fonts.indexOf(i)!==-1?" selected":"")+">"+testFonts[i]+"</option>"}}fontsInput.insertAdjacentHTML("afterbegin",fontsHTML);document.getElementById("textOutput").style.textAlign=settings.align;if(isNumber(settings.width)){document.getElementById("textOutput").style.width=settings.width+"px"}else if(settings.width==="auto"){document.getElementById("textOutput").style.width=settings.width}if(settings.size&&isNumber(settings.size)){document.getElementById("textOutput").style.fontSize=settings.size+"px"}formatText();document.getElementById("coloredInput").checked=settings.colored;document.getElementById("tiltedInput").checked=settings.tilted;document.getElementById("casedInput").checked=settings.cased;document.getElementById("spacedInput").checked=settings.spaced;document.getElementById("sizedInput").checked=settings.sized;document.getElementById("groupedInput").checked=settings.sized;document.getElementById("styledInput").checked=settings.styled;document.getElementById("weightedInput").value=settings.weighted;document.getElementById("alignInput").value=settings.align;document.getElementById("widthInput").value=settings.width;document.getElementById("sizeInput").value=settings.size;document.getElementById("widthInput").addEventListener("change",function(){var value=this.value?this.value:"auto";if(parseInt(value,10)){value=parseInt(value,10);document.getElementById("textOutput").style.width=value+"px";settings.width=value}else if(value==="auto"){document.getElementById("textOutput").style.width=value;settings.width="auto"}});document.getElementById("sizeInput").addEventListener("change",function(){var value=this.value?this.value:50;if(parseInt(value,10)){value=parseInt(value,10);document.getElementById("textOutput").style.fontSize=value+"px";settings.size=value;applySizes()}});document.getElementById("textInput").addEventListener("change",function(){settings.text=this.value;formatText()});document.getElementById("coloredInput").addEventListener("change",function(){if(this.checked){settings.colored=true;applyColors()}else{settings.colored=false;var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){value.style.backgroundColor=null;value.style.color=null;value.style.border=null})}});document.getElementById("sizedInput").addEventListener("change",function(){if(this.checked){settings.sized=true;applySizes()}else{settings.sized=false;var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){value.style.fontSize=null})}});document.getElementById("groupedInput").addEventListener("change",function(){if(this.checked){settings.grouped=true}else{settings.grouped=false}formatText()});document.getElementById("tiltedInput").addEventListener("change",function(){if(this.checked){settings.tilted=true;applyTilts()}else{settings.tilted=false;var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){value.style.transform=null})}});document.getElementById("casedInput").addEventListener("change",function(){if(this.checked){settings.cased=true;applyCases()}else{settings.cased=false;var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){value.style.textTransform=null})}});document.getElementById("spacedInput").addEventListener("change",function(){if(this.checked){settings.spaced=true;applySpaces()}else{settings.spaced=false;var elements=document.getElementById("textOutput").querySelectorAll(".space");forEach(elements,function(index,value){value.innerHTML="&nbsp;"})}});document.getElementById("styledInput").addEventListener("change",function(){if(this.checked){settings.styled=true;applyStyles()}else{settings.styled=false;var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){value.style.fontStyle=null})}});document.getElementById("weightedInput").addEventListener("change",function(){if(this.checked){settings.weighted=true;applyWeights()}else{settings.weighted=false;var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){value.style.fontWeight=null})}});document.getElementById("alignInput").addEventListener("change",function(){document.getElementById("textOutput").style.textAlign=this.value});document.getElementById("fontsInput").addEventListener("change",function(){fontIndexes=getSelectValues(this);if(fontIndexes[0]){settings.fonts=fontIndexes.map(function(index){return testFonts[Number(index)]});applyFonts()}else{var elements=document.getElementById("textOutput").querySelectorAll(".letter");forEach(elements,function(index,value){value.style.fontFamily=null})}});document.getElementById("saveImage").addEventListener("click",function(){saveImage()});document.getElementById("selectAllFonts").addEventListener("click",function(){selectAllFonts(fontsInput)});document.getElementById("invertFonts").addEventListener("click",function(){invertFonts(fontsInput)});document.getElementById("selectAllOptions").addEventListener("click",function(){selectAllOptions(checkboxes)});document.getElementById("invertOptions").addEventListener("click",function(){invertOptions(checkboxes)});document.getElementById("reloadText").addEventListener("click",function(){formatText()});